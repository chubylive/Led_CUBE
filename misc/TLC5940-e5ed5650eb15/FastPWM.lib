https://mbed.org/users/Sissors/code/FastPWM/#3094d3806cfc
